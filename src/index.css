/* Google Fonts are now loaded via HTML head for better CSP compliance */

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom scrollbar styles */
@layer utilities {
  .scrollbar-thin {
    scrollbar-width: thin;
  }
  
  .scrollbar-thumb-border {
    scrollbar-color: hsl(var(--border)) transparent;
  }
  
  .scrollbar-track-transparent {
    scrollbar-track-color: transparent;
  }
  
  /* WebKit scrollbar for Chrome/Safari */
  .scrollbar-thin::-webkit-scrollbar {
    width: 6px;
  }
  
  .scrollbar-thin::-webkit-scrollbar-track {
    background: transparent;
  }
  
  .scrollbar-thin::-webkit-scrollbar-thumb {
    background: hsl(var(--border));
    border-radius: 3px;
  }
  
  .scrollbar-thin::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--border) / 0.8);
  }

  /* Line clamp utilities */
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
}

@layer base {
  :root {
    --background: 220 15% 8%;
    --foreground: 220 10% 88%;

    --card: 220 14% 11%;
    --card-foreground: 220 10% 88%;

    --popover: 220 14% 11%;
    --popover-foreground: 220 10% 88%;

    --primary: 210 100% 65%;
    --primary-foreground: 220 15% 8%;

    --secondary: 220 12% 14%;
    --secondary-foreground: 220 10% 75%;

    --muted: 220 10% 16%;
    --muted-foreground: 220 8% 55%;

    --accent: 210 100% 65%;
    --accent-foreground: 220 15% 8%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 220 10% 88%;

    --border: 220 10% 18%;
    --input: 220 10% 18%;
    --ring: 210 100% 65%;

    --radius: 0.375rem;

    --sidebar-background: 220 14% 11%;
    --sidebar-foreground: 220 10% 88%;
    --sidebar-primary: 210 100% 65%;
    --sidebar-primary-foreground: 220 15% 8%;
    --sidebar-accent: 220 10% 16%;
    --sidebar-accent-foreground: 220 10% 88%;
    --sidebar-border: 220 10% 18%;
    --sidebar-ring: 210 100% 65%;

    /* Custom tokens */
    --code-bg: 220 12% 12%;
    --code-border: 220 10% 20%;
    --surface: 220 14% 10%;

    /* Typography */
    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
    --font-display: 'Playfair Display', Georgia, serif;
    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    font-family: var(--font-sans);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  code, pre {
    font-family: var(--font-mono);
  }
}

/* Markdown prose styles */
@layer components {
  .prose {
    @apply text-foreground leading-normal w-full;
    max-width: 90ch;
  }

  .prose h1 {
    @apply text-2xl sm:text-3xl font-bold mt-6 mb-2 leading-snug;
  }

  .prose h2 {
    @apply text-xl sm:text-2xl font-bold mt-6 mb-2 leading-snug;
  }

  .prose h3 {
    @apply text-lg font-bold mt-4 mb-1.5 leading-snug;
  }

  .prose h4 {
    @apply text-base font-bold mt-3 mb-1 leading-snug;
  }

  .prose p {
    @apply mb-3 text-[15px] leading-[1.6];
    color: hsl(var(--foreground) / 0.9);
  }

  .prose a {
    @apply underline underline-offset-4 decoration-primary/40 hover:decoration-primary transition-colors;
    color: hsl(var(--primary));
  }

  .prose strong {
    @apply font-semibold;
    color: hsl(var(--foreground));
  }

  .prose blockquote {
    @apply border-l-4 border-primary/50 pl-4 my-3 italic;
    color: hsl(var(--muted-foreground));
  }

  .prose ul {
    @apply list-disc pl-6 mb-3 space-y-1;
    color: hsl(var(--foreground) / 0.9);
  }

  .prose ol {
    @apply list-decimal pl-6 mb-3 space-y-1;
    color: hsl(var(--foreground) / 0.9);
  }

  .prose li {
    @apply leading-[1.5] text-[15px];
  }

  .prose code:not(pre code) {
    @apply text-sm px-1.5 py-0.5 rounded;
    background: hsl(var(--code-bg));
    border: 1px solid hsl(var(--code-border));
    color: hsl(var(--primary));
    font-family: var(--font-mono);
  }

  .prose pre {
    @apply rounded-md p-3 my-3 overflow-x-auto text-[13px] leading-snug;
    background: hsl(var(--code-bg)) !important;
    border: 1px solid hsl(var(--code-border));
    font-family: var(--font-mono);
  }

  .prose pre code {
    @apply p-0 bg-transparent border-0 text-[13px];
    color: hsl(var(--foreground) / 0.9);
  }

  /* Code block wrapper with language label */
  .prose .code-block-wrapper {
    @apply relative my-3;
  }

  .prose .code-block-wrapper .code-block-lang {
    @apply text-[10px] font-mono font-semibold uppercase tracking-wider px-3 py-1 rounded-t-md;
    background: hsl(var(--code-bg));
    border: 1px solid hsl(var(--code-border));
    border-bottom: none;
    color: hsl(var(--primary));
    display: inline-block;
  }

  .prose .code-block-wrapper pre {
    @apply mt-0;
    border-top-left-radius: 0;
  }

  .prose .code-block-wrapper .code-block-lang + pre {
    margin-top: 0 !important;
  }

  .prose img {
    @apply rounded-md my-4 w-full;
  }

  .prose hr {
    @apply my-4 border-border;
  }

  /* Responsive table wrapper â€” enables horizontal scroll on small screens */
  .prose .table-responsive-wrapper {
    @apply w-full my-4 overflow-x-auto rounded-md;
    -webkit-overflow-scrolling: touch;
    /* subtle scroll shadow hint on the right edge */
    background:
      linear-gradient(to right, transparent, transparent),
      linear-gradient(to right, hsl(var(--background)), hsl(var(--background))),
      linear-gradient(to right, hsl(var(--border) / 0.25), transparent);
    background-repeat: no-repeat;
    background-size: 40px 100%, 8px 100%, 8px 100%;
    background-position: right center, right center, right center;
    background-attachment: local, local, scroll;
  }

  .prose table {
    @apply w-full text-sm border-collapse;
    min-width: 480px; /* always show full table; wrapper scrolls on mobile */
  }

  .prose thead {
    @apply border-b border-border;
  }

  .prose th {
    @apply text-left py-2 px-3 font-semibold text-sm whitespace-nowrap;
    color: hsl(var(--foreground));
    background: hsl(var(--secondary) / 0.5);
  }

  .prose th:first-child { border-radius: 0.375rem 0 0 0; }
  .prose th:last-child  { border-radius: 0 0.375rem 0 0; }

  .prose td {
    @apply py-2 px-3 border-b border-border/50 text-sm;
    color: hsl(var(--foreground) / 0.85);
  }

  .prose tr:last-child td {
    @apply border-b-0;
  }

  .prose tbody tr:hover td {
    background: hsl(var(--secondary) / 0.3);
  }
}

/* Syntax highlighting */
.hljs {
  background: transparent !important;
  color: hsl(var(--foreground) / 0.9) !important;
}

.hljs-keyword,
.hljs-selector-tag {
  color: hsl(280 65% 72%) !important;
}

.hljs-string,
.hljs-attr {
  color: hsl(100 55% 62%) !important;
}

.hljs-comment {
  color: hsl(var(--muted-foreground)) !important;
  font-style: italic;
}

.hljs-function,
.hljs-title {
  color: hsl(200 75% 72%) !important;
}

.hljs-number {
  color: hsl(30 85% 65%) !important;
}

.hljs-built_in {
  color: hsl(50 75% 65%) !important;
}

/* Scrollbar */
::-webkit-scrollbar {
  width: 5px;
  height: 5px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: hsl(var(--border));
  border-radius: 3px;
}

/* Floating animations */
@keyframes float-slow {
  0%, 100% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-20px);
  }
}

@keyframes float-medium {
  0%, 100% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-15px);
  }
}

@keyframes float-fast {
  0%, 100% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-10px);
  }
}

.animate-float-slow {
  animation: float-slow 6s ease-in-out infinite;
}

.animate-float-medium {
  animation: float-medium 4s ease-in-out infinite;
}

.animate-float-fast {
  animation: float-fast 3s ease-in-out infinite;
}

/* Custom scrollbar for sidebar */
.scrollbar-thin {
  scrollbar-width: thin;
  scrollbar-color: hsl(var(--border)) transparent;
}

.scrollbar-thin::-webkit-scrollbar {
  width: 4px;
}

.scrollbar-thin::-webkit-scrollbar-track {
  background: transparent;
}

.scrollbar-thin::-webkit-scrollbar-thumb {
  background-color: hsl(var(--border));
  border-radius: 20px;
}

.scrollbar-thin::-webkit-scrollbar-thumb:hover {
  background-color: hsl(var(--muted-foreground));
}
